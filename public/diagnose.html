<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¸»é¡µè¯Šæ–­</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            background: #f0f2f5;
            padding: 15px;
        }
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .card h2 {
            color: #2563EB;
            font-size: 18px;
            margin-bottom: 15px;
            border-bottom: 2px solid #2563EB;
            padding-bottom: 10px;
        }
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        .status-item:last-child { border-bottom: none; }
        .status-label { color: #666; font-size: 14px; }
        .status-value { font-weight: bold; }
        .success { color: #10B981; }
        .error { color: #EF4444; }
        .warning { color: #F59E0B; }
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: #2563EB;
            color: white;
            text-align: center;
            text-decoration: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            margin: 10px 0;
        }
        .btn-secondary {
            background: #6B7280;
        }
        #log {
            background: #1F2937;
            color: #10B981;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #10B981;
            padding-left: 10px;
        }
        .log-error {
            border-left-color: #EF4444;
            color: #EF4444;
        }
    </style>
</head>
<body>
    <div class="card">
        <h2>ğŸ” ä¸»é¡µè¯Šæ–­å·¥å…·</h2>
        <div id="status"></div>
    </div>
    
    <div class="card">
        <h2>ğŸ“Š è®¾å¤‡ä¿¡æ¯</h2>
        <div class="status-item">
            <span class="status-label">å±å¹•å®½åº¦</span>
            <span class="status-value" id="width">-</span>
        </div>
        <div class="status-item">
            <span class="status-label">å±å¹•é«˜åº¦</span>
            <span class="status-value" id="height">-</span>
        </div>
        <div class="status-item">
            <span class="status-label">è®¾å¤‡ç±»å‹</span>
            <span class="status-value" id="device">-</span>
        </div>
        <div class="status-item">
            <span class="status-label">æµè§ˆå™¨</span>
            <span class="status-value" id="browser">-</span>
        </div>
    </div>
    
    <div class="card">
        <h2>ğŸ“ è¯Šæ–­æ—¥å¿—</h2>
        <div id="log"></div>
    </div>
    
    <a href="/" class="btn">è®¿é—®æ­£å¼ä¸»é¡µ</a>
    <a href="/test-mobile.html" class="btn btn-secondary">åŸºç¡€æµ‹è¯•é¡µé¢</a>
    
    <script>
        // æ—¥å¿—å‡½æ•°
        function addLog(message, type = 'info') {
            const log = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = 'log-entry' + (type === 'error' ? ' log-error' : '');
            entry.textContent = new Date().toLocaleTimeString() + ' - ' + message;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
        
        // æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯
        const width = window.innerWidth;
        const height = window.innerHeight;
        const ua = navigator.userAgent;
        
        document.getElementById('width').textContent = width + 'px';
        document.getElementById('height').textContent = height + 'px';
        
        let device = 'æœªçŸ¥';
        if (/Android/i.test(ua)) device = 'Android';
        else if (/iPhone/i.test(ua)) device = 'iPhone';
        else if (/iPad/i.test(ua)) device = 'iPad';
        else device = 'æ¡Œé¢è®¾å¤‡';
        
        document.getElementById('device').textContent = device;
        document.getElementById('browser').textContent = ua.split(' ').pop();
        
        addLog('è¯Šæ–­å¼€å§‹');
        addLog('è®¾å¤‡ï¼š' + device + ' (' + width + 'x' + height + ')');
        
        // æµ‹è¯•å„ä¸ªèµ„æº
        const tests = [
            { name: 'JavaScript', url: null, type: 'js' },
            { name: 'é¦–é¡µ HTML', url: '/', type: 'html' },
            { name: 'React JS', url: '/static/js/main.1a86b8bd.js', type: 'js' },
            { name: 'CSS æ–‡ä»¶', url: '/static/css/main.9234d814.css', type: 'css' },
            { name: 'å¤´åƒå›¾ç‰‡', url: '/images/image001.png', type: 'image' }
        ];
        
        let passed = 0;
        let failed = 0;
        
        // é€ä¸ªæµ‹è¯•
        tests.forEach((test, index) => {
            setTimeout(() => {
                if (test.type === 'js' && !test.url) {
                    // JavaScript æœ¬èº«
                    addLog('âœ… ' + test.name + ' æ­£å¸¸');
                    passed++;
                    updateStatus();
                } else {
                    // æµ‹è¯•èµ„æºåŠ è½½
                    fetch(test.url)
                        .then(response => {
                            if (response.ok) {
                                addLog('âœ… ' + test.name + ' å¯è®¿é—® (' + response.status + ')');
                                passed++;
                            } else {
                                addLog('âŒ ' + test.name + ' é”™è¯¯ (' + response.status + ')', 'error');
                                failed++;
                            }
                            updateStatus();
                        })
                        .catch(err => {
                            addLog('âŒ ' + test.name + ' å¤±è´¥ï¼š' + err.message, 'error');
                            failed++;
                            updateStatus();
                        });
                }
            }, index * 500);
        });
        
        function updateStatus() {
            const status = document.getElementById('status');
            const total = passed + failed;
            
            if (total === 0) {
                status.innerHTML = '<div class="status-item"><span class="status-label">æµ‹è¯•ä¸­...</span></div>';
            } else if (failed === 0) {
                status.innerHTML = '<div class="status-item"><span class="status-label" style="color:#10B981">âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ (' + passed + '/' + total + ')</span></div>';
            } else {
                status.innerHTML = '<div class="status-item"><span class="status-label" style="color:#EF4444">âŒ å‘ç° ' + failed + ' ä¸ªé—®é¢˜ (' + passed + '/' + total + ')</span></div>';
            }
            
            // æ‰€æœ‰æµ‹è¯•å®Œæˆåç»™å‡ºå»ºè®®
            if (total === tests.length) {
                if (failed > 0) {
                    addLog('âš ï¸ å»ºè®®ï¼šæ£€æŸ¥æœåŠ¡å™¨æ–‡ä»¶æ˜¯å¦æ­£ç¡®æ›´æ–°', 'error');
                    addLog('âš ï¸ æ‰§è¡Œï¼šsudo cp /var/www/leiman-website/* /www/server/nginx/html/', 'error');
                } else {
                    addLog('âœ… æ‰€æœ‰èµ„æºåŠ è½½æ­£å¸¸ï¼Œé—®é¢˜å¯èƒ½åœ¨ React æ¸²æŸ“');
                    addLog('ğŸ’¡ å»ºè®®ï¼šè®¿é—®æ­£å¼ä¸»é¡µè¯•è¯•');
                }
            }
        }
        
        // æ•è·å…¨å±€é”™è¯¯
        window.onerror = function(msg, url, line) {
            addLog('âŒ é”™è¯¯ï¼š' + msg + ' (ç¬¬' + line + 'è¡Œ)', 'error');
        };
    </script>
</body>
</html>
